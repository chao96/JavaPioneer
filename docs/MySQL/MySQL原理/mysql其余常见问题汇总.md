### 一、SQL语句有时候突然变慢了？

> 当内存数据页跟磁盘数据页内容不一致的时候，称这个内存页为“脏页”。内存数据写入磁盘后，内存和磁盘一致了，称为“干净页”。

有几种情况：

第一种，redo log满了，系统会停止更新操作，刷脏页。

第二种，系统内存不足，当需要新的内存页时，内存不够用，就要淘汰一些数据页。

## 二、不同Count用法的差别

count(字段)<count(主键 id)<count(1)≈count(*)



## 三、order by 排序

**sort_buffer_size**，就是 MySQL 为排序开辟的内存（sort_buffer）的大小。如果要排序的数据量小于 sort_buffer_size，排序就在内存中完成。但如果排序数据量太大，内存放不下，则利用磁盘临时文件辅助排序（归并算法）

**“Using filesort”**表示的就是需要排序

**全字段排序 VS rowid排序**

内存足够大，会优先选择全字段排序，不用回表查

## 四、Mysql怎样高可用

正常情况下，只要主库执行更新生成的所有 binlog，都可以传到备库并被正确地执行，备库就能达到跟主库一致的状态，这就是最终一致性。

与**数据同步**有关的时间点主要包括以下三个：

+ 主库 A 执行完成一个事务，写入 binlog，我们把这个时刻记为 T1;

+ 之后传给备库 B，我们把备库 B 接收完这个 binlog 的时刻记为 T2;

+ 备库 B 执行完成这个事务，我们把这个时刻记为 T3。

**主备延迟**，也就是 T3-T1

**主备延迟最直接的表现是，备库消费中转日志（relay log）的速度，比主库生产 binlog 的速度要慢**

**主备延迟来源**：

1.备库所在的机器性能差

2.备库的压力大

3.大事务

**解决主备延迟方案**：

1.一主多从。分担读的压力
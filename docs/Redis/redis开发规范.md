
# 一、键值设计

## 1.key名设计
1） 可读性和可管理性
以业务名或（数据库名）为前缀（防止key冲突），用冒号分割，格式业务名:表名:id
如：ugc:video:1

2） 简洁性
在保证语义的前提下，控制key的长度，当key较多时，内存占用也不容忽视。如：
user:{uid}:friends:messages:{mid}简化为u:{uid}:fr:m:{mid}

3）不要包含特殊字符

## 2.value设计
### ① 拒绝bigkey
+ String类型控制在10Kb以内
+ hash、list、set、zset元素个数不要超过5000

危害：
+ 网络阻塞
+ redis阻塞
+ 集群节点数据不均衡
+ 频繁序列化：应用服务器CPU消耗

### ② 选择合适的数据结构
全String、全hash、分段hash

### ③ 过期设计
+ 周期数据需要设置过期时间
+ 过期时间不宜集中：缓存穿透、缓存雪崩

# 二、命令使用技巧
## 1.O（n）以上命令关注n的数量

## 2.禁用命令
禁止线上使用keys、flushall、flushdb等，通过redis的raname机制禁掉

## 3.合理使用select
+ redis的多数据库较弱、使用数据进行区分
+ 同时多业务用多数据库实际还是单线程处理，会有干扰

## 4.redis事务功能较弱，不建议过多使用
+ redis的事务功能较弱（不支持回滚）

## 5.redis集群版本在使用Lua上有特殊要求

## 6.必要情况下使用monitor命令是，注意不要长时间使用

# 三、Java客户端优化
## 1.避免多个应用使用一个redis实例
不相干的业务拆分，公共数据做服务化

## 2.使用连接池